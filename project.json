{
  "name": "esp32-dynamic-data",
  "boards": [
    {
      "type": "esp32-devkitc",
      "components": [
        { "type": "led", "pin": 26 },
        { "type": "led", "pin": 27 }
      ]
    }
  ],
  "sketch": "#include <WiFi.h>\n#include <WebServer.h>\n#include <uri/UriBraces.h>\n#include <ArduinoJson.h>\n\n#define WIFI_SSID \"Wokwi-GUEST\"\n#define WIFI_PASSWORD \"\"\n#define WIFI_CHANNEL 6\n\nWebServer server(80);\n\nconst int LED1 = 26;\nconst int LED2 = 27;\n\nbool led1State = false;\nbool led2State = false;\n\nvoid sendHtml() {\n  String response = R\"(\n    <!DOCTYPE html><html>\n      <head>\n        <title>ESP32 Web Server Demo</title>\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n        <style>\n          html { font-family: sans-serif; text-align: center; }\n          body { display: inline-flex; flex-direction: column; }\n          h1 { margin-bottom: 1.2em; } \n          h2 { margin: 0; }\n          div { display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: auto auto; grid-auto-flow: column; grid-gap: 1em; }\n          .btn { background-color: #5B5; border: none; color: #fff; padding: 0.5em 1em;\n                 font-size: 2em; text-decoration: none }\n          .btn.OFF { background-color: #333; }\n        </style>\n      </head>\n            \n      <body>\n        <h1>ESP32 Web Server</h1>\n\n        <div>\n          <h2>LED 1</h2>\n          <a href=\"/toggle/1\" class=\"btn LED1_TEXT\">LED1_TEXT</a>\n          <h2>LED 2</h2>\n          <a href=\"/toggle/2\" class=\"btn LED2_TEXT\">LED2_TEXT</a>\n        </div>\n      </body>\n    </html>\n  )\";\n  response.replace(\"LED1_TEXT\", led1State ? \"ON\" : \"OFF\");\n  response.replace(\"LED2_TEXT\", led2State ? \"ON\" : \"OFF\");\n  server.send(200, \"text/html\", response);\n}\n\nvoid logStatus() {\n  StaticJsonDocument<200> doc;\n  doc[\"led1\"] = led1State ? \"ON\" : \"OFF\";\n  doc[\"led2\"] = led2State ? \"ON\" : \"OFF\";\n  doc[\"temperature\"] = random(20, 35);\n  doc[\"humidity\"] = random(40, 80);\n  doc[\"timestamp\"] = millis();\n  String jsonString;\n  serializeJson(doc, jsonString);\n  Serial.println(jsonString);\n}\n\nvoid setup(void) {\n  Serial.begin(115200);\n  pinMode(LED1, OUTPUT);\n  pinMode(LED2, OUTPUT);\n  randomSeed(analogRead(0));\n\n  WiFi.begin(WIFI_SSID, WIFI_PASSWORD, WIFI_CHANNEL);\n  Serial.print(\"Connecting to WiFi \");\n  Serial.print(WIFI_SSID);\n  while (WiFi.status() != WL_CONNECTED) {\n    delay(100);\n    Serial.print(\".\");\n  }\n  Serial.println(\" Connected!\");\n\n  Serial.print(\"IP address: \");\n  Serial.println(WiFi.localIP());\n\n  server.on(\"/\", sendHtml);\n\n  server.on(UriBraces(\"/toggle/{}\"), []() {\n    String led = server.pathArg(0);\n    Serial.print(\"Toggle LED #\");\n    Serial.println(led);\n\n    switch (led.toInt()) {\n      case 1:\n        led1State = !led1State;\n        digitalWrite(LED1, led1State);\n        break;\n      case 2:\n        led2State = !led2State;\n        digitalWrite(LED2, led2State);\n        break;\n    }\n\n    sendHtml();\n  });\n\n  server.begin();\n  Serial.println(\"HTTP server started\");\n}\n\nvoid loop(void) {\n  server.handleClient();\n  static unsigned long lastLogTime = 0;\n  if (millis() - lastLogTime >= 1000) {\n    lastLogTime = millis();\n    logStatus();\n  }\n  delay(100);\n}"
}
